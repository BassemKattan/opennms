<?xml version="1.0" encoding="UTF-8"?>
<thresholding-config xmlns="http://xmlns.opennms.org/xsd/config/thresholding-config">
    <group name="TH-Storage-High-95" rrdRepository="${install.share.dir}/rrd/snmp/">
        <threshold
            description="Basic disk threshold for disk drives filled up over 95 percent"
            type="high" ds-type="dskIndex" value="90.0" rearm="75.0"
            trigger="2" ds-label="ns-dskPath" filterOperator="or" ds-name="ns-dskPercent"/>
        <expression
            description="Basic disk threshold for disk drives filled up over 95 percent"
            type="high" ds-type="hrStorageIndex" value="95.0"
            rearm="80.0" trigger="2" ds-label="hrStorageDescr"
            filterOperator="or" expression="hrStorageUsed / hrStorageSize * 100.0">
            <resource-filter field="hrStorageType">^\.1\.3\.6\.1\.2\.1\.25\.2\.1\.4$</resource-filter>
        </expression>
    </group>
    <group name="TH-Storage-Relative-33" rrdRepository="${install.share.dir}/rrd/snmp/">
        <threshold
            description="Basic disk threshold when the percentage of disk space used on any disk increases by 33.3% compared to its most recent previous measurement"
            type="relativeChange" ds-type="dskIndex" value="1.333"
            rearm="0.0" trigger="1" ds-label="ns-dskPath"
            filterOperator="or" ds-name="ns-dskPercent">
            <resource-filter field="ns-dskPath">^(?:(?!(/proc|/sys|/dev/pts)).)+$</resource-filter>
        </threshold>
        <expression
            description="Basic disk threshold when the percentage of disk space used on any disk increases by 33.3% compared to its most recent previous measurement"
            type="relativeChange" ds-type="hrStorageIndex" value="1.333"
            rearm="0.0" trigger="1" ds-label="hrStorageDescr"
            filterOperator="or" expression="hrStorageUsed / hrStorageSize * 100.0">
            <resource-filter field="hrStorageType">^\.1\.3\.6\.1\.2\.1\.25\.2\.1\.4$</resource-filter>
        </expression>
    </group>
    <group name="TH-Network-Discards-High-5" rrdRepository="${install.share.dir}/rrd/snmp/">
        <expression
            description="Basic network threshold for over 5 in- or outgoing discarded frames per second in two consecutive measurements"
            type="high" ds-type="if" value="5.0" rearm="0.0" trigger="2"
            ds-label="ifName" filterOperator="or" expression="ifInDiscards + ifOutDiscards"/>
    </group>
    <group name="TH-System-Temp-High-55" rrdRepository="${install.share.dir}/rrd/snmp/">
        <threshold
            description="Basic threshold for Cisco environment temperature sensors"
            type="high" ds-type="ciscoEnvMonTemperatureStatusIndex"
            value="55.0" rearm="50.0" trigger="3"
            ds-label="cvmTempStatusDescr" filterOperator="or" ds-name="cvmTempStatusValue"/>
    </group>
    <group name="TH-Network-Bandwidth-High-90" rrdRepository="${install.share.dir}/rrd/snmp/">
        <expression
            description="Basic incoming network bandwidth usage over 90% for 5 consecutive measurements"
            type="high" ds-type="if" value="90.0" rearm="75.0"
            trigger="5" ds-label="ifName" filterOperator="or" expression="((ifHCInOctets * 8) / (ifHighSpeed * 1000000)) * 100">
            <resource-filter field="ifHighSpeed">^[1-9]+[0-9]*$</resource-filter>
        </expression>
        <expression
            description="Basic outgoing network bandwidth usage over 90% for 5 consecutive measurements"
            type="high" ds-type="if" value="90.0" rearm="75.0"
            trigger="5" ds-label="ifName" filterOperator="or" expression="((ifHCOutOctets * 8) / (ifHighSpeed * 1000000)) * 100">
            <resource-filter field="ifHighSpeed">^[1-9]+[0-9]*$</resource-filter>
        </expression>
    </group>
</thresholding-config>
