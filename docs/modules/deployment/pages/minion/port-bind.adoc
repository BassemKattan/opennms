
[[minion-port-bind]]
= Binding Minion to Privileged Ports

ifeval::["{page-component-title}" == "Horizon"]
NOTE: {page-component-title} Versions 29.0.0 and later no longer run with root privileges.
You must manually allow {page-component-title} to bind to privileged ports.
+
If you upgrade from a version that binds to privileged ports natively to one that does not, you must either update all endpoints targeting a {page-component-title} instance and route their messages to a non-privileged port, or apply a workaround to allow {page-component-title} to receive messages on the same port as it did before the upgrade.
endif::[]

You can bind a Minion to privileged ports (less than `1024`) using a manual workaround.

== Requirements

You must have a modern Linux Kernel (3.0+) and the following capabilities set:

* CAP_NET_RAW (to send ICMP as a non-privileged user)
* CAP_NET_BIND_SERVICE (to bind to port numbers below `1024` as a not-privileged user)

See xref:deployment:core/getting-started.adoc#set-up-core-instance[Set up the core instance] for instructions on assigning CAP_NET_RAW capabilities.

== Set up workaround

You can allow a Minion to bind to privileged ports using the following instructions:

* Set the `User` key to `minion` in the systemd configuration settings.
* Set `PING_REQUIRED=FALSE` in `/etc/init.d/minion`.
+
This forces the Minion to skip the `ensure-user-ping.sh` script, which requires root privileges.
* Restart the systemd daemon using the `systemctl daemon-reload` command.
* Restart the {page-component-title} service using the `systemctl restart opennms` command.

You should now be able to bind a Minion to privileged ports.
