
[[newts-monitor]]
= Newts Monitoring

This section describes the metrics that {page-component-title} collects for monitoring the Newts keyspace from `org.apache.cassandra.metrics.Keyspace` on a Cassandra node.

JMX must be enabled on the Cassandra nodes and made accessible from {page-component-title} to collect these metrics (
see https://docs.datastax.com/en/cassandra/3.0/cassandra/configuration/secureJmxAuthentication.html[Enabling JMX authentication and authorization]).

The data collection process is bound to the agent IP interface whose service name is `JMX-Cassandra-Newts`.
The JMXCollector retrieves MBean entities from the Cassandra node.

== Memtable data size

[options="autowidth"]
|===
| Name  | Description

| AllMemtablesLiveDataSize
| Total amount of live data stored in the memtables (2i and pending flush memtables included) that reside off heap, excluding any data structure overhead.

| AllMemtablesOffHeapDataSize
| Total amount of data stored in the memtables (2i and pending flush memtables included) that reside off heap.

| AllMemtablesOnHeapDataSize
| Total amount of data stored in the memtables (2i and pending flush memtables included) that reside on heap.
|===

== Memtable switch count

[options="autowidth"]
|===
| Name  | Description

| MemtableSwitchCount
| Number of times flush has resulted in the memtable being switched out.
|===

== Memtable columns count

[options="autowidth"]
|===
| Name  | Description

| MemtableColumnsCount
| Total number of columns present in the memtable.
|===

== Memory table data size

[options="autowidth"]
|===
| Name  | Description

| MemtableLiveDataSize
| Total amount of live data stored in the memtable, excluding any data structure overhead.

| MemtableOffHeapDataSize
| Total amount of data stored in the memtable that resides off heap, including column-related overhead and partitions overwritten.

| MemtableOnHeapDataSize
| Total amount of data stored in the memtable that resides on-heap, including column-related overhead and partitions overwritten.
|===

== Read and write latency

[options="autowidth"]
|===
| Name  | Description

| ReadTotalLatency
| Local read metrics

| WriteTotalLatency
| Local write metrics
|===

== Range latency

[options="autowidth"]
|===
| Name  | Description

| RangeLatency 99th Percentile
| Local range slice metrics 99th percentile
|===

=== Latency

[options="autowidth"]
|===
| Name  | Description

| CasCommitTotalLatency
| Time spent on Casandra commits since process start.

| CasPrepareTotalLatency
| Time spent on Casandra prepare events since process start.

| CasProposeTotalLatency
| Time spent on Casandra propose events since process start.
|===

== Bloom filter disk space

[options="autowidth"]
|===
| Name  | Description

| BloomFilterDiskSpaceUsed
| Disk space that the bloom filter uses.
|===

== Bloom filter off-heap memory

[options="autowidth"]
|===
| Name  | Description

| BloomFilterOffHeapMemoryUsed
| Off-heap memory that the bloom filter uses.
|===

== Newts memory used

[options="autowidth"]
|===
| Name  | Description

| CompressionMetadataOffHeapMemoryUsed
| Off-heap memory that the compression metadata uses.

| IndexSummaryOffHeapMemoryUsed
| Off-heap memory that the index summary uses.
|===

== Pending

[options="autowidth"]
|===
| Name  | Description

| PendingCompactions
| Estimated number of pending compactions for this column family.

| PendingFlushes
| Estimated number of pending flushes for this column family.
|===

== Disk space

[options="autowidth"]
|===
| Name  | Description

| TotalDiskSpaceUsed
| Total disk space used by SSTables belonging to this column family including obsolete ones waiting to be garbage collected.

| LiveDiskSpaceUsed
| Disk space used by SSTables belonging to this column family.
|===
