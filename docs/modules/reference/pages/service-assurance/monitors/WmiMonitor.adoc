
= WmiMonitor

The WMI monitor

This monitor implements <<reference:service-assurance/introduction.adoc#ref-service-assurance-monitors-placeholder-substitution-parameters, placeholder substitution in parameter values>>.

== Monitor facts

[cols="1,7"]
|===
| Class Name
| `org.opennms.netmgt.poller.monitors.WmiMonitor`
|===

== Configuration and use

.Monitor-specific parameters for the WmiMonitor
[options="header"]
[cols="1,3,2"]
|===
| Parameter
| Description
| Default

3+| *Required*

| matchType
| Tells the OpenNMS WMI system to deal with multiple instance results. Available match types are:
- all - all instances must comply to the compare operation.
- none - no instances should comply with the compare operation.
- some - only some (1 or more) must comply with the compare operation.
- one - only one instance can comply with the compare operation.
|

| wmiClass
| Class of instances within WMI; for example, `Win32_ComputerSystem`.
|

| wmiObject
| Member of a WMI property set.
For example, the `Win32_ComputerSystem` class contains properties that we can look at and poll.
The default "WMI" service uses the "Status" property to determine if the system is running and if WMI is available.
| Status

| compareOp
| The "compare operation" is how you tell the OpenNMS WMI poller plugins how to verify the nature (up, critical) of a specific property within WMI. In the event of unequal comparisons the system will always have the WMI value (as retrieved from the target) on the left. Available compare operations are:

    EQ (Equals)
    NEQ (Not Equals)
    GT (Greater Than)
    LT (Less Than)
    NOOP (No Operation)

The NOOP operation is a special case in which the Manager will always return a result code of "OK." This is typical used in scenarios where the existence of a class or property is more interesting than the contents of the property. We use this in the collector to check and ensure that WMI is available before attempting to collect data. 
|

| compareValue
|
|

| service-name
|
| WMI



3+|*Optional*

| retry
| Number of attempts to get a valid FTP response/response-text.
| 0


|===

kbd:[{}] _indicates the parameter supports <<reference:service-assurance/introduction.adoc#ref-service-assurance-monitors-placeholder-substitution-parameters, placeholder substitution>>._

This monitor implements the <<reference:service-assurance/introduction.adoc#ref-service-assurance-monitors-common-parameters, Common Configuration Parameters>>.

== Example

[source, xml]
----
 <!-- Customization: enable monitoring that already discovered WMI services are still running -->
    <service name="WMI" interval="300000" user-defined="false" status="on">
      <parameter key="retry" value="2" />
      <parameter key="timeout" value="30000" />
      <parameter key="matchType" value="all"/>
      <parameter key="wmiClass" value="Win32_ComputerSystem" />
      <parameter key="wmiObject" value="Status" />
      <parameter key="compareOp" value="EQ" />
      <parameter key="compareValue" value="OK" />
      <parameter key="service-name" value="WMI" />
    </service>

<monitor service="WMI" class-name="org.opennms.netmgt.poller.monitors.WmiMonitor" />
----
