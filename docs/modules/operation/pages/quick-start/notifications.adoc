
= Step 2: Turn on Default Notifications

This section describes how to turn on default notifications in {page-component-title}.

{page-component-title} uses notifications to inform users about events in the network without requiring them to log in to the web UI.
Notifications are commonly sent through email and text/pager messages, but can be customized to send to a variety of external systems.
For additional information, including alternative notification mechanisms, see xref:operation:deep-dive/notifications/introduction.adoc[Notifications] in the Deep Dive section and the xref:reference:daemons/daemon-config-files/notifd.adoc[notifd daemon] reference section.

== Enable notifications

Notifications are disabled by default in a fresh {page-component-title} installation.
Follow these steps to enable notifications:

. Log in as a user with admin privileges.
. Click the *Gear* icon in the top-right of the screen.
. Under Event Management, click *On* beside Notification Status, and click *Update*.

image::notifications/notifications-on.png[notifications-on, 300]

The green bell icon indicates that notifications are enabled globally.

NOTE: The workflow above is functionally equivalent to editing `$\{OPENNMS_HOME}/etc/notifd-configuration.xml` and setting `status="on"` in the top-level `notifd-configuration` element.
This configuration file update happens immediately, with no need to restart {page-component-title}.

== Configure destination paths

A destination path specifies the "who" (recipient), "when" (delay), and "how" (method) of a notification.
It also specifies escalation targets.
Configuring destination paths separately from individual events lets you use the same information for multiple notifications.
This minimizes duplication and encourages reuse.

Follow these steps to configure a destination path:

. Log in as a user with admin privileges.
. Click the *Gear* icon in the top-right of the screen, and choose menu:Event Management[Configure Notifications > Configure Destination Paths].
. Click *New Path*, fill in the desired information, and click *Finish*.
** To add a destination path, select it from the list in the *Destinations Path* screen, and click *Edit*.

It is possible to define multiple notifications for the same unique event identifier (UEI) to use different destination paths.
By default, {page-component-title} runs the destination path of all notifications matching the event's UEI.
You can configure notifd to process only the destination path of the first matching notification by editing `$\{OPENNMS_HOME}/etc/notifd-configuration.xml` and setting `match-all="false"` in the top-level `notifd-configuration` element.

NOTE: Configuration of destination paths is stored in `$\{OPENNMS_HOME}/etc/destinationPaths.xml`.
Changes to this file happen immediately, with no need to restart {page-component-title}.

== Configure event notifications

An event notification defines a destination path and message template for a specific event UEI.
It is possible to define multiple notifications for the same UEI to utilize different filters, destination paths, and/or message templates.
Configure event notifications by following these steps:

. Log in as a user with admin privileges.
. Click the *Gears* icon in the top-right of the screen, and choose menu:Event Management[Configure Notifications > Configure Event Notifications].
The screen displays a list of events that are configured for notifications.
. Click *Add New Event Notification*.
. (Optional) Build a rule to match a subset of IP addresses or services, and click menu:Validate Rule Results[Next] or *Skip Results Validation*.
. In the *Choose Path* screen, specify information to be included in the notification, including the destination path, subject (for an email message), body text, and so on.
. Click *Finish*.

NOTE: Event notification configuration is stored in `$\{OPENNMS_HOME}/etc/notifications.xml`.
Changes to this file happen immediately, with no need to restart {page-component-title}.

=== Filter rules

The filter rule configured in `$\{OPENNMS_HOME}/etc/notifications.xml` (for example, `<rule>IPADDR != '0.0.0.0'</rule>`) is not strict by default.
That means if there is an event that is not associated with a node or interface, it will not validate the rule and, by default, the notification would be saved.
A strict rule (for example, `<rule strict="true">IPADDR != '0.0.0.0'</rule>`) will always be evaluated, and if there is no node or interface associated with the event, the notification will not be saved.

== Configure path outages

Configuring a path outage lets you suppress notifications for nodes that appear to be down due to a failure in the network path between the nodes and {page-component-title}.
For example, if a WAN link fails, all nodes at the remote site served by the WAN link will appear to be down.
Because you get a notification that the router on the far end of the WAN link is not responding, you don't need notifications for all devices that sit behind that router.

You can configure a path outage for an individual node, or create a rule-based configuration for a group of nodes:

. Log in as a user with admin privileges.
. Click the *Gear* icon in the top-right of the screen, and choose menu:Event Management[Configure Notifications > Configure Path Outages].
. Enter the critical path IP address, select a critical path service, and click *Next*.
