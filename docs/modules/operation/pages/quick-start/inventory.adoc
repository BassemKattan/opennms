
[[provision-getting-started]]
= Step 3: Provision Inventory

{page-component-title} installs with a base configuration that automatically begins service-level monitoring and reporting as soon as you identify and catalog (provision) the managed entities (nodes, IP interfaces, SNMP interfaces, and services) you want to monitor.

{page-component-title} has three methods of provisioning:

* xref:deep-dive/provisioning/auto-discovery.adoc[] (automatically add nodes).
* xref:deep-dive/provisioning/directed-discovery.adoc[] (manually add nodes).
* xref:development:rest/rest-api.adoc#rest-api[Asset import] through the RestAPI.

Regardless of the method, provisioning is an iterative process.
You will need to fine-tune your results to exclude or add to what you monitor.

This quick start presents a very basic example of auto and manual discovery of nodes, through SNMP.
Beyond this quick start, you can complete additional tasks to provision your system:

* Use plugins to integrate with external systems.
* Specify more complex entity detection with OpenNMS detectors (ActiveMQ, DNS, FTP, JDBC, TCP, and so on).
* Create policies to manage provisioning behavior.

Refer to xref:operation:deep-dive/provisioning/introduction.adoc[Provisioning] in the deep-dive section for details about these and other provisioning-related tasks.

[[provision-snmp-configuration]]
== Configure SNMP for provisioning

To collect data through SNMP or monitor the availability of SNMP services on a node, you need to configure SNMP for provisioning before using auto or directed discovery.
This ensures that {page-component-title} can immediately scan newly discovered devices for entities.

Proper SNMP configuration lets {page-component-title} understand network/node topology and automatically enables performance data collection.
Very basic ... might not be optimized ...
Run default, try to detect a lot of stuff ... 
Policies are also part of optimizing, and not necessary for the QS.

{page-component-title} updates network topology as it provisions nodes.

. In the web UI, click the gear icon in the top right.
. In the *Provisioning* area, choose *Configure SNMP Community Names by IP Address*.
. Specify an IP address range in the *First IP Address* and *Last IP Address* fields and accept the default values for the other fields.
. Click *Save Config*.
+
This screen sets up SNMP within {page-component-title} for agents listening on IP addresses 10.1.1.1 through 10.254.254.254.

.Configure SNMP community names
image::provisioning/SNMP_Config.png[SNMP-configuration, 600]

These settings are optimized into the `snmp-config.xml` file.

For an example of the resulting XML configuration, see xref:operation:deep-dive/provisioning/xml-samples.adoc#SNMP-community-xml[Configure SNMP community names].

[[requisition-create]]
== Create a requisition

A requisition is a set of nodes (networked devices) that you want to import into {page-component-title} for monitoring and management.
You can iteratively build a requisition and later actually import the nodes in the requisition into {page-component-title}.
Doing so processes all of the adds/changes/deletes at once.

TIP: Organize nodes with a similar network monitoring profile into a requisition, so that you can assign the same services, detectors, and policies to model the network monitoring behavior (for example, routers or switches).

This procedure describes how to create an empty requisition.
Links to additional information on customizing a requisition appear at the end of the procedure.

You can do discovery without a requisition and edit it later, but we recommend creating a req.
Don't need to define services, means it will include it even if it's false.

The requisition editor in the OpenNMS web UI (Admin -> Manage Provisioning Requisitions) is designed for very small-scale usage. Do not attempt to use this interface to edit requisitions containing more than a few dozen nodes; itâ€™s simply not designed for that use case and will fail in sometimes spectacular ways.

Requisition also includes FS definition and policies. We will accept the defaults. By default, FS 

. In the web UI, click the gear icon in the top right.
. In the *Provisioning* area, choose *Manage Provisioning Requisitions*.
. Click *Edit Default FS* to see the default detectors the default foreign source definition uses.

If you haven't already, xref:foreign-source-definition[edit the default foreign source definition] to define services to detect.
. Click *Add Requisition*, type a name, and click *OK*.

NOTE: The requisition remains red until you synchronize it with the database.
Synchronize after you configure discovery.

image::provisioning/red_requisition.png[]

Once created, you can add nodes to the requisition.

[[configure-discovery]]
== Configure discovery
For this quick start ... do not have a list of nodes to start from.
Specify general settings like timeouts and retries, as well as the addresses you want to scan.

. In the web UI, click the gear icon in the top right.
. In the *Provisioning* area, choose *Configure Discovery*.
. In the *General Settings* area, select the requisition you just created from the *Requisition* list.
.. (optional) Change the default values, if desired.
. Click *Save and Restart Discovery*.
. Go to *Manage Provisioning Requsitions* and click the *Synchronize the Requisition* icon, choose a scan option, and click *Synchronize*.

You can view imported nodes under *Info > Nodes*.

* xref:deep-dive/provisioning/directed-discovery.adoc#directed-discovery[Manually specify nodes to add to a requisition]
* xref:deep-dive/provisioning/auto-discovery.adoc#auto-discovery[Automatically discover nodes to add to a requisition]
* Customize a requisition with xref:reference:provisioning/detectors.adoc#ref-detectors[detectors] and xref:deep-dive/provisioning/policies.adoc#policies[policies]


[[foreign-source-definition]]
== Edit Default Foreign Source Definition

The default foreign source definition serves as a template that defines the services to detect on (DNS, FTP, ICMP, and so on), the scan interval for discovery, and the policies to use when provisioning.

Policies determine entity persistence and/or set attributes on the discovered entities that control {page-component-title} management behavior.
Provisiond applies the existing default foreign source definition unless you choose to modify it.
