
[[ga-flow-support-introduction]]
= Flows

Flows are summaries of network traffic sent by network devices (switches, routers, and so on).
This information includes, but is not limited to, source and destination addresses, source and destination ports, octet count, and duration of activity.

Collecting and analyzing flows data provides a picture of network usage and helps to diagnose issues.
Persisting flows for long-term storage can aid in forensic analysis.

{page-component-title} provides the following:

* A platform to collect, persist, and visualize flows, with support for NetFlow versions 5 and 9, IPFIX, and sFlow.
* Inventory enrichment (mapping to {page-component-title} nodes).
* Application classification.
* Horizontal scaling.
* Enterprise reporting.
* Top K statistics by interface, application, host, conversation with QoS.

See the <<reference:telemetryd/protocols/introduction.adoc#ref-protocol, Telemetry>> section for a list of supported protocols.

This section presents a set of procedures to set up flows that progress from a basic environment to more complex:

* xref:deep-dive/flows/basic.adoc#flows-basic[Basic setup].
* Collect flows data in a xref:deep-dive/flows/distributed.adoc#flows-remote[distributed/remote network] (add a Minion).
* Process a xref:deep-dive/flows/sentinel/sentinel.adoc#flows-scaling[large volume of flows data] (add Sentinel to scale).
* Issues with flows at scale and queries taking too long (add the OpenNMS https://github.com/OpenNMS/nephron[streaming analytics tool]).

== How it works

At a high level, with a xref:deep-dive/flows/basic.adoc#flows-basic[basic setup], {page-component-title} processes flows as follows:

* <<deep-dive/telemetryd/introduction.adoc#ga-telemetryd, Telemetryd>> receives and decodes flows.
* Telemetryd adapters convert the flows to a canonical flow model.
* Flows are enriched:
** The <<deep-dive/flows/classification-engine.adoc#ga-flow-support-classification-engine, classification engine>> tags flows and groups them under a name based on a set of rules.
** Metadata related to associated nodes (such as IDs and categories) are added to the flows.
* Enriched flows are persisted in Elasticsearch and/or forwarded to Kafka.
* (Optional) The OpenNMS streaming analytics tool aggregates flows and outputs them to Elasticsearch, Cortex, or Kafka.
* (Optional) The REST API generates summaries and time series data from the flows or aggregates stored on Elasticsearch.
* OpenNMS Helm visualizes flows and aggregates:
** The Flow Deep Dive dashboard visualizes flows and aggregates that are stored in Elasticsearch using a flows datasource.
** The Cortex Flow Deep Dive dashboard uses a Prometheus datasource to visualize aggregates that are stored in Cortex.

.Overview of flows integration
image::flows/flow_integration_overview.png[Network graph displays how flows integrate with OpenNMS, 700]

=== Technologies

{page-component-title} supports the following flows technologies:

[options="header" cols="1,1,1,1,1"]
|===
| Feature
| NetFlow v5
| NetFlow v9
| sFlow
| IPFIX

| *Open/Proprietary*
| Proprietary
| Proprietary
| Open
| Open

| *Sampled/Flow-Based*
| Primarily flow-based; sampled mode available.
| Primarily flow-based; sampled mode available.
| Sampled
| Primarily flow-based; sampled mode available.

| *Information Captured*
| Metadata and statistical information, including bytes transferred, interface counters, and so on.
| Metadata and statistical information, including bytes transferred, interface counters, and so on.
| Complete packet headers, partial packet payloads.
| Metadata and statistical information, including bytes transferred, interface counters, and so on.

| *Ingress/Egress Monitoring*
| Ingress only
| Ingress and egress
| Ingress and egress
| Ingress and egress

| *IPv6/VLAN/MPLS Support*
| No
| Yes
| Yes
| Yes
|===
