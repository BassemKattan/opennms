// Allow GitHub image rendering
:imagesdir: ../../images

=== Getting Started

{opennms-product-name} installs with a base configuration that automatically begins service-level monitoring and reporting as soon as you provision managed entities (nodes, IP interfaces, SNMP interfaces, and services).

{opennms-product-name} has three methods of provisioining:

* xref:discovery-auto[Auto discovery]
* xref:discovery-directed[Directed discovery]
* link:#asset-import[asset import] through the UI or the https://docs.opennms.org/pris/branches/master/pris/pris.html[provisioning integration server] (PRIS)

Use auto discovery if you do not have a "source of truth" for your network inventory; auto discovery can become that source. Be aware that auto discovery can generate too much information, including entities you do not want to monitor. 

Directed discovery is effective if you know your inventory. It is also useful for areas of your network that you cannot auto discover.

Import assets in the {opennms-product-name} UI using a comma-separated (.csv) file or by integrating single or multiple external inventory systems with PRIS. 

See the link:#provisioning-works[how it works] section of the introdution for more information on the provisioning process. 

Regardless of the method, provisioning is an iterative process: you will need to fine-tune your results to exclude or add things to what you monitor.

==== Before You Begin

If you collect data via SNMP or are monitoring the availability of the SNMP service on a node, you must xref:provision-snmp-configuration [configure SNMP for provisioning] before using auto or directed discovery. 
This ensures that {opennms-product-name} can immediately scan newly discovered devices for entities.
It also makes reporting and thresholding available for these devices.

In addition, you may want to xref:foreign-source-definition[edit the default foreign source definition] to specify the services to detect and policies to apply during discovery. 

[[provision-snmp-configuration]]
==== Configuring SNMP for Provisioning

Proper SNMP configuration allows {opennms-product-name} to understand network and node topology as well as to automatically enable performance data collection.
{opennms-product-name} updates network topology as it provisions nodes.

. In the web UI, click the gear icon in the top right. 
. In the *Provisioning* area, choose *Configure SNMP Community Names by IP Address*, and fill in the fields as desired: 

.Configuring SNMP community names
image:../images/provisioning/SNMP_Config.png[]

This screen sets up SNMP within {opennms-product-name} for agents listening on IP addresses 10.1.1.1 through 10.254.254.254.
These settings are optimized into the `snmp-configuration.xml` file.
Optimization means that the minimal configuration possible will be written.
Any IP addresses already configured that are eclipsed by this range will be removed.

For an example of the resulting XML configuration, see link:#SNMP-commmunity-xml[Configuring SNMP community names].

NOTE: Provisiond includes an option to add community information to a single IP address through the link:#quick-add-node[Quick-Add Node] feature. 

Now, with SNMP configuration provisioned for our 10 networks, we are ready to begin adding nodes.
Our first example will be to automatically discover and add all managed entities (nodes, IP interfaces, SNMP interfaces, and monitored IP-based services).
We will then give an example of how to be more directed and deliberate about your discovery by using provisioning groups.

[[foreign-source-definition]]
==== Edit Default Foreign Source Definition

The default foreign source definition serves as a template that defines the services to detect on (DNS, FTP, ICMP, etc.), the scan interval for discovery, and the policies to use when provisioning. 

Policies determine entity persistence and/or set attributes on the discovered entities that control {opennms-product-name} management behavior. 
Provisiond applies the default default foreign source definintion unless you choose to modify it. 

.Edit detectors and set scan interval

. In the web UI, click the gear icon in the top right. 
. In the *Provisioning* area, choose *Manage Provisioning Requisitions*. 
. Click *Edit Default FS*. 

+

image:../images/provisioning/FS_def.png[]

+

NOTE: The screen displays the list of service detectors and a tab to view and define policies. 
Provisiond scans the services in the order in which the detectors appear in the list. 

. Click the appropriate icon to edit, delete, or move a service detector. 
.. You can also add parameters to a detector, including retries, timeout, port, etc.) by clicking the Edit icon and choosing *Add Parameter*. 
. Click *Save*. 
. If desired, update the scan interval using one of the following:

+ 

* w: Weeks
* d: Days
* h: Hours
* m: Minutes
* s: Seconds
* ms: Milliseconds

For example, to rescan every six days and 53 minutes, use `6d 53m`.
Specify `0` to disable automatic scanning. 

.Create policies

. Create policies ... 