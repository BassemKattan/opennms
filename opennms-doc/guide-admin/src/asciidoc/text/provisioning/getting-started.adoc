
// Allow GitHub image rendering
:imagesdir: ../images

=== Getting Started

{opennms-product-name} installs with a base configuration that automatically begins service-level monitoring and reporting as soon as you provision managed entities (nodes, IP interfaces, SNMP interfaces, and services).

{opennms-product-name} has two methods of provisioining:

* xref:discovery-auto[Auto discovery]
* xref:discovery-directed[Directed discovery]

Use auto discovery if you do not have a "source of truth" for your network inventory; auto discovery can become that source. Be aware that auto discovery can generate too much information, including entities you do not want to monitor. 

Directed discovery is effective if you know your inventory. It is also useful for areas of your network that you cannot auto discover.  

Regardless of the method, provisioning is an iterative process: you will need to fine-tune your results to exclude or add things to what you monitor.

If you collect data via SNMP or are monitoring the availability of the SNMP service on a node, you must xref:provision-snmp-configuration [configure SNMP for provisioning] before using auto or directed discovery. 
This ensures that {opennms-product-name} can immediately scan newly discovered devices for entities.
It also makes reporting and thresholding available for these devices.

[[provision-snmp-configuration]]
==== Configuring SNMP for Provisioning

Proper SNMP configuration allows {opennms-product-name} to understand network and node topology as well as to automatically enable performance data collection.
{opennms-product-name} updates network topology as it provisions nodes.

. In the web UI, click the gear icon in the top right. 
. In the *Provisioning* area, choose *Configure SNMP Community Names by IP Address*, and fill in the fields as desired: 

.Configuring SNMP community names
image:../images/provisioning/SNMP_Config.png[]

This screen sets up SNMP within {opennms-product-name} for agents listening on IP addresses 10.1.1.1 through 10.254.254.254.
These settings are optimized into the `snmp-configuration.xml` file.
Optimization means that the minimal configuration possible will be written.
Any IP addresses already configured that are eclipsed by this range will be removed.

For an example of the resulting XML configuration, see link:#SNMP-commmunity-xml[Configuring SNMP community names].

NOTE: Provisiond includes an option to add community information to a single IP address through the link:#quick-add-node[Quick-Add Node] feature. 

Now, with SNMP configuration provisioned for our 10 networks, we are ready to begin adding nodes.
Our first example will be to automatically discover and add all managed entities (nodes, IP interfaces, SNMP interfaces, and monitored IP-based services).
We will then give an example of how to be more directed and deliberate about your discovery by using _Provisioning Groups_.

[[foreign-source-definition]]
==== Foreign Source

A _foreign source_ uniquely identifies an external (foreign) provisioning source and any node entities it is requesting to import into {opennms-product-name}.

A _foreign ID_ is the unique node ID maintained in the foreign system and the foreign source.

{opennms-product-name} uses the combination of the foreign source and foreign ID as a unique foreign key when synchronizing the set of nodes from each source with the nodes in the {opennms-product-name} database.
This is how provisiond decides if a node entity from an import requisition is new, has been changed, or needs to be deleted.

==== Directed

It is important to understand that the nodes requisitioned from each foreign source are managed as a complete set.
Nodes defined in a requisition from the foreign source _CRM_ and _CMDB_, for example, will be managed separately from each other even if they should contain exactly the same node definitions.
To {opennms-product-name}, these are individual entities and they are managed as a set.

Requisitions are referenced via a URL.
Currently, the URL can be specified as one of the following protocols: FILE, HTTP, HTTPS, and DNS.
Each protocol has a protocol handler that is used to stream the XML from a _foreign source_, i.e. http://inv.corp.org/import.cgi?customer=acme or `file:/opt/opennms/etc/imports/acme.xml`.
The DNS protocol is a special handler developed for Provisioning sets of nodes as a _foreign-source_ from a corporate DNS server.
See DNS Protocol Handler for details.

This determination is made by comparing the set foreign IDs of each node in the requisition set with the set of foreign IDs of currently managed entities in {opennms-product-name}.

When nodes are provisioned using the Provisioning Groups Web-UI, the requisitions are stored on the local file system and the file protocol handler is used to reference the requisition.
Each Provisioning Group is a separate foreign source and unique foreign IDs are generated by the Web-UI.
An MSP might use Provisioning Groups to define the set of nodes to be managed by customer name where each customerâ€™s set of nodes are maintained in a separate Provisioning Group.